import { NextPage } from "next";
import Head from "next/head";
import Image from "next/image";

interface IPost {
  id: number;
  title: string;
  description: string;
  content: string;
  image: string;
}

interface IProps {
  title: string;
  post: IPost;
}

const myLoader = ({ src }: any) => {
  return `http://113.30.190.164:5000/${src}`;
};

const PostPage: NextPage<IProps> = ({ title, post }) => {
  return (
    <>
      <Head>
        <title>{title}</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>
        <h1>{post.title}</h1>
        <Image
          loader={myLoader}
          src={post.image}
          alt="Picture of the author"
          width={500}
          height={500}
        />
        <h5>{post.description}</h5>
        <p>{post.content}</p>
      </main>
    </>
  );
};

PostPage.getInitialProps = async ({ query }) => {
  const title = query.title as string;
  const res = await fetch(`http://113.30.190.164:5000/posts/name/${title}`);
  const post = await res.json();
  const data = {
    title,
    post,
  };
  return { ...data };
};

export default PostPage;
